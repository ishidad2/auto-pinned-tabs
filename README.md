# Auto Pinned Tabs (WXT版)

Chromeの起動時に、**指定したフォルダ内のブックマークをすべて「固定タブ」として自動展開する**拡張機能です。
WXTフレームワークを使用して構築されており、高速な開発とメンテナンス性を両立しています。

---

## 🚀 主な機能

- **自動展開:** Chromeの起動イベント（`onStartup`）を検知して、即座にブックマークを開きます。
- **固定表示（Pinned Tabs）:** 開いたタブはすべて自動的に「固定（ピン留め）」されるため、作業スペースがスッキリします。
- **簡単設定:** 拡張機能アイコンをクリックするとポップアップが表示され、対象とするブックマークフォルダをプルダウンで選択するだけで設定完了です。
- **重複タブ防止:** 起動時に既存の固定タブをクリアしてから新しく開くため、プロファイル切り替え時などでもタブが重複しません。
- **セキュリティ対策:** http/httpsスキームのURLのみを許可し、危険なスキーム（javascript:, data:, file:など）をブロックします。
- **ルートフォルダ除外:** ブックマークのルートフォルダは選択肢から除外され、実際のフォルダのみが表示されます。

---

## 🛠️ セットアップと開発方法

### 1. 依存関係のインストール

プロジェクトのルートディレクトリで以下を実行してください。

Bash

`npm install`

### 2. 開発モードでの起動

Bash

`npm run dev`

- 自動的にChromeの新しいインスタンスが立ち上がり、拡張機能がロードされます。
- コードを変更すると、**HMR（ホットリロード）**により即座にブラウザに反映されます。

### 3. ビルド（配布用ファイルの作成）

Bash

`npm run build`

- `.output/` フォルダに、Chromeストアへアップロード可能な形式のファイルが生成されます。

---

## 📂 ファイル構成

```
.
├── entrypoints/
│   ├── background.ts      # 起動時のメインロジック（URL検証、タブ管理）
│   ├── popup/             # ポップアップUI（拡張機能アイコンクリック時）
│   │   ├── index.html
│   │   └── main.ts
│   └── options/           # オプション画面（フォルダ選択UI）
│       ├── index.html
│       └── main.ts
├── utils/
│   └── bookmark-helpers.ts # ブックマーク関連のユーティリティ関数
├── wxt.config.ts          # WXT/Manifestの設定
└── package.json
```

---

## 📖 使い方

### 初回設定

1. **拡張機能のアイコンをクリック**して、ポップアップを開きます。
   - または、拡張機能の詳細画面から「**拡張機能のオプション**」を開くこともできます。
2. **「起動時に開くフォルダ」**のプルダウンから、対象のブックマークフォルダを選択します。
3. 設定は**自動で保存**されます（「保存しました！」と表示されます）。

### 実際の動作

4. Chromeを**完全に終了**し、再度立ち上げます。
5. 指定したフォルダ内のブックマークが、**固定タブとして自動的に開かれます**。

### フォルダの変更

- フォルダを変更したい場合は、再度ポップアップまたはオプション画面から別のフォルダを選択してください。
- 次回起動時には、新しいフォルダのブックマークが開かれます（古いタブは自動的にクリアされます）。

---

## ⚠️ 注意事項

- **起動時の挙動:** Chromeの「設定 ＞ 起動時」の設定内容によっては、新しいタブが1つ余分に開くことがあります。
- **ブックマーク権限:** この拡張機能はブックマークを読み取るため、インストール時に権限の確認が表示されます。
- **固定タブのクリア:** ブラウザ起動時に既存の固定タブが全てクリアされます。手動で固定したタブは保持されません。
- **URLスキーム制限:** セキュリティ保護のため、http/https以外のスキーム（javascript:, data:, file:など）のブックマークは開かれません。
- **プロファイル切り替え:** 複数のプロファイルを使用している場合でも、各プロファイルで独立して設定・動作します。

## 🔒 セキュリティ機能

この拡張機能には以下のセキュリティ対策が組み込まれています：

- **URLスキーム検証:** ブックマークのURLを開く前に、安全なスキーム（http/https）のみを許可します。
- **XSS攻撃防止:** `javascript:` スキームのブックマークは自動的にブロックされます。
- **ローカルファイルアクセス防止:** `file:` スキームのブックマークは開かれません。
- **最小権限の原則:** 必要最小限の権限（bookmarks、tabs、storage）のみを要求します。

---

## 🤝 ライセンス

MIT License